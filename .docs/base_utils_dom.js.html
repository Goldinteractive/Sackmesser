<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: base/utils/dom.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: base/utils/dom.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * DOM module.
 * @module base/utils/dom
 */

import * as easingEquations from 'easing-js/easing'
import { isNumeric } from './check'
import { extend } from './object'

/**
 * Return computed styles
 *
 * @param   {Element} element - Element to get computed style from.
 * @returns {Object} Computed styles
 */
function getComputedStyles(element) {
  var computedStyle = {},
      styles = {}

  computedStyle = window.getComputedStyle(element, null)

  for (let i = 0, length = computedStyle.length; i &lt; length; i++) {
    var prop = computedStyle[i]
    var val = computedStyle.getPropertyValue(prop)
    styles[prop] = val
  }

  return styles
}

/**
 * Request animation frame polyfill method.
 *
 * @see https://www.paulirish.com/2011/requestanimationframe-for-smart-animating/
 * @see https://developer.mozilla.org/de/docs/Web/API/window/requestAnimationFrame
 */
var rAF = (function() {
  return window.requestAnimationFrame
    || window.webkitRequestAnimationFrame
    || window.mozRequestAnimationFrame
    || function(callback) {
      window.setTimeout(callback, 1000 / 60)
    }
})()


/**
 * Scroller class.
 * Scroll to position or element using custom speeds and easings.
 */
class Scroller {

  /**
   * Constructor.
   * @param {Object} options
   *   Overwrite the [default options]{@link module:base/utils/dom~Scroller.defaultOptions}.
   */
  constructor(options = {}) {
    this._opts = extend(Scroller.defaultOptions, options)
  }

  /**
   * Scroll to given element.
   *
   * @param {Element} element - Target element.
   * @param {Object} options
   *   Overwrite the [default to options]{@link module:base/utils/dom~Scroller.defaultToOptions}.
   *
   * @return {module:base/utils/dom~Scroller}
   */
  toElement(element, options = {}) {
    var opts = extend(options, {
      y: element.offsetTop,
      x: element.offsetLeft
    })

    return this
  }

  /**
   * Scroll to a target position.
   *
   * @param {Object} options
   *   Overwrite the [default to options]{@link module:base/utils/dom~Scroller.defaultToOptions}.
   *
   * @return {module:base/utils/dom~Scroller}
   */
  to(options = {}) {
    var timeX = 0, timeY = 0, currentTime = 0,
      scrollY = window.scrollY || document.documentElement.scrollTop,
      scrollX = window.scrollX || document.documentElement.scrollLeft

    var opts = extend(this._opts, Scroller.defaultToOptions, options),
      scrollTargetX = opts.x,
      scrollTargetY = opts.y

    if (scrollTargetX) {
      scrollTargetX = scrollTargetX - opts.offsetX
      scrollTargetX = scrollTargetX &lt; 0 ? 0 : scrollTargetX

      // determine scroll time for x axis
      timeX = Math.max(
        opts.minScrollTime,
        Math.min(
          Math.abs(scrollX - scrollTargetX) / opts.speed, opts.maxScrollTime
        )
      )
    }

    if (scrollTargetY) {
      scrollTargetY = scrollTargetY - opts.offsetY
      scrollTargetY = scrollTargetY &lt; 0 ? 0 : scrollTargetY

      // determine scroll time for y axis
      timeY = Math.max(
        opts.minScrollTime,
        Math.min(
          Math.abs(scrollY - scrollTargetY) / opts.speed, opts.maxScrollTime
        )
      )
    }

    var time = Math.max(timeX, timeY)

    // add animation loop
    function tick() {
      currentTime += 1 / 60

      var p = currentTime / time
      var t = easingEquations[opts.easing](p)

      var posY = scrollTargetY ? scrollY + ((scrollTargetY - scrollY) * t) : scrollY
      var posX = scrollTargetX ? scrollX + ((scrollTargetX - scrollX) * t) : scrollX

      if (p &lt; 1) {
        rAF(tick)
        window.scrollTo(posX, posY)
      } else {
        window.scrollTo(scrollTargetX || scrollX, scrollTargetY || scrollY)
        if (opts.cb) opts.cb()
      }
    }

    // call it once to get started
    tick()
    return this
  }

}

/**
 * Default scroller options.
 *
 * @type {Object}
 * @property {Number} speed=1000 - Scrolling speed (pixels per second).
 * @property {Number} easing='easeOutSine' - [Easing equation]{@link https://github.com/danro/easing-js/blob/master/easing.js}.
 * @property {Number} offsetX=0 - Offset that is taken away from target x position (e.g. for a fixed sidebar width).
 * @property {Number} offsetY=0 - Offset that is taken away from target y position (e.g. for a fixed header height).
 * @property {Number} minScrollTime=0.1 - Minimum scrolling time.
 * @property {Number} maxScrollTime=0.8 - Maximum scrolling time.
 */
Scroller.defaultOptions = {
  speed: 1000,
  easing: 'easeOutSine',
  offsetY: 0,
  offsetX: 0,
  minScrollTime: 0.1,
  maxScrollTime: 0.8
}

/**
 * Default options for scrolling to methods.
 * These will extend the [default options]{@link module:base/utils/dom~Scroller.defaultOptions}.
 *
 * @type {Object}
 * @property {Number} x=null - Target position on x axis.
 * @property {Number} y=null - Target position on y axis.
 * @property {Function} cb=null - Callback to execute when scrolling has finished.
 */
Scroller.defaultToOptions = {
  x: null,
  y: null,
  cb: null
}


export {
  /**
   * Scroller class.
   * @see module:base/utils/dom~Scroller
   */
  Scroller,

  rAF, getComputedStyles
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-base.html">base</a></li><li><a href="module-base_events.html">base/events</a></li><li><a href="module-base_features.html">base/features</a></li><li><a href="module-base_utils.html">base/utils</a></li><li><a href="module-base_utils_array.html">base/utils/array</a></li><li><a href="module-base_utils_check.html">base/utils/check</a></li><li><a href="module-base_utils_device.html">base/utils/device</a></li><li><a href="module-base_utils_dom.html">base/utils/dom</a></li><li><a href="module-base_utils_events.html">base/utils/events</a></li><li><a href="module-base_utils_func.html">base/utils/func</a></li><li><a href="module-base_utils_object.html">base/utils/object</a></li><li><a href="module-base_utils_string.html">base/utils/string</a></li><li><a href="module-base_utils_url.html">base/utils/url</a></li></ul><h3>Classes</h3><ul><li><a href="module-base_events-EventHub.html">EventHub</a></li><li><a href="module-base_features-Feature.html">Feature</a></li><li><a href="module-base_utils_device-DeviceInfo.html">DeviceInfo</a></li><li><a href="module-base_utils_dom-Scroller.html">Scroller</a></li><li><a href="module-base_utils_events-Emitter.html">Emitter</a></li><li><a href="RandomQuote.html">RandomQuote</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Mon Jan 16 2017 12:04:20 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
